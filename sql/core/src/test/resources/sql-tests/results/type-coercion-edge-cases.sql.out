-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE t1(col1 TIMESTAMP, col2 MAP<BIGINT, DOUBLE>)
-- !query schema
struct<>
-- !query output



-- !query
SELECT MEAN(col1) FROM t1
-- !query schema
struct<mean(col1):double>
-- !query output
NULL


-- !query
SELECT col2.field FROM t1
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkNumberFormatException
{
  "errorClass" : "CAST_INVALID_INPUT",
  "sqlState" : "22018",
  "messageParameters" : {
    "ansiConfig" : "\"spark.sql.ansi.enabled\"",
    "expression" : "'field'",
    "sourceType" : "\"STRING\"",
    "targetType" : "\"BIGINT\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 17,
    "fragment" : "col2.field"
  } ]
}


-- !query
SELECT NULL:a AS b
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkException
{
  "errorClass" : "INTERNAL_ERROR",
  "sqlState" : "XX000",
  "messageParameters" : {
    "message" : "Cannot find main error class 'COLUMN_IS_NOT_VARIANT_TYPE'"
  }
}


-- !query
DROP TABLE t1
-- !query schema
struct<>
-- !query output

