-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE t1(col1 INT, col2 STRING)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE t2(col1 STRUCT<a: STRING>, a STRING)
-- !query schema
struct<>
-- !query output



-- !query
SELECT LEN(LOWER('X')) AS a, 1 AS b, b AS c GROUP BY LOWER('X') ORDER BY LOWER('X')
-- !query schema
struct<a:int,b:int,c:int>
-- !query output
1	1	1


-- !query
SELECT LEN(LOWER('X')) AS a, 1 AS b, b AS c GROUP BY LOWER('X') HAVING LOWER('X') = 'x'
-- !query schema
struct<a:int,b:int,c:int>
-- !query output
1	1	1


-- !query
SELECT col1.field, field FROM VALUES(named_struct('field', 1))
-- !query schema
struct<field:int,field:int>
-- !query output
1	1


-- !query
SELECT col1.field, field FROM VALUES(map('field', 1))
-- !query schema
struct<field:int,field:int>
-- !query output
1	1


-- !query
SELECT COUNT(col1) as alias, SUM(col1) + alias FROM t1 GROUP BY ALL
-- !query schema
struct<alias:bigint,(sum(col1) + lateralAliasReference(alias)):bigint>
-- !query output
0	NULL


-- !query
SELECT COUNT(col1) as alias, SUM(col1) + alias, SUM(col1) + col1 FROM t1 GROUP BY ALL
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.ExtendedAnalysisException
{
  "errorClass" : "UNRESOLVED_ALL_IN_GROUP_BY",
  "sqlState" : "42803",
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 74,
    "stopIndex" : 85,
    "fragment" : "GROUP BY ALL"
  } ]
}


-- !query
DROP TABLE t1
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE t2
-- !query schema
struct<>
-- !query output

