-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE t1(col1 STRUCT<a: STRING>, a STRING)
-- !query analysis
CreateDataSourceTableCommand `spark_catalog`.`default`.`t1`, false


-- !query
SELECT col1.a, a FROM t1 ORDER BY a
-- !query analysis
Sort [a#x ASC NULLS FIRST], true
+- Project [col1#x.a AS a#x, a#x]
   +- SubqueryAlias spark_catalog.default.t1
      +- Relation spark_catalog.default.t1[col1#x,a#x] parquet


-- !query
SELECT col1.a, a FROM t1 ORDER BY col1.a
-- !query analysis
Project [a#x, a#x]
+- Sort [col1#x.a ASC NULLS FIRST], true
   +- Project [col1#x.a AS a#x, a#x, col1#x]
      +- SubqueryAlias spark_catalog.default.t1
         +- Relation spark_catalog.default.t1[col1#x,a#x] parquet


-- !query
SELECT split(col1, '-')[1] AS a FROM VALUES('a-b') ORDER BY split(col1, '-')[1]
-- !query analysis
Project [a#x]
+- Sort [split(col1#x, -, -1)[1] ASC NULLS FIRST], true
   +- Project [split(col1#x, -, -1)[1] AS a#x, col1#x]
      +- LocalRelation [col1#x]


-- !query
DROP TABLE t1
-- !query analysis
DropTable false, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t1
