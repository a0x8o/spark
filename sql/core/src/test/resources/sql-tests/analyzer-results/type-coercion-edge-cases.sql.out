-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE t1(col1 TIMESTAMP, col2 MAP<BIGINT, DOUBLE>)
-- !query analysis
CreateDataSourceTableCommand `spark_catalog`.`default`.`t1`, false


-- !query
SELECT MEAN(col1) FROM t1
-- !query analysis
Aggregate [mean(cast(col1#x as double)) AS mean(col1)#x]
+- SubqueryAlias spark_catalog.default.t1
   +- Relation spark_catalog.default.t1[col1#x,col2#x] parquet


-- !query
SELECT col2.field FROM t1
-- !query analysis
Project [col2#x[cast(field as bigint)] AS field#x]
+- SubqueryAlias spark_catalog.default.t1
   +- Relation spark_catalog.default.t1[col1#x,col2#x] parquet


-- !query
SELECT NULL:a AS b
-- !query analysis
org.apache.spark.SparkException
{
  "errorClass" : "INTERNAL_ERROR",
  "sqlState" : "XX000",
  "messageParameters" : {
    "message" : "Cannot find main error class 'COLUMN_IS_NOT_VARIANT_TYPE'"
  }
}


-- !query
DROP TABLE t1
-- !query analysis
DropTable false, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.t1
